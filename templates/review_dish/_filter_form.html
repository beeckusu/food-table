<form method="get" id="filterForm">
    <!-- Search Section -->
    <div class="border-bottom p-3">
        <h6 class="mb-3"><i class="bi bi-search"></i> Search</h6>
        <div class="input-group input-group-sm">
            <input type="text" class="form-control" id="search" name="search"
                   placeholder="Search dishes..."
                   value="{{ filter_params.search }}">
            {% if filter_params.search %}
            <button type="button" class="btn btn-outline-secondary" onclick="document.getElementById('search').value=''; document.getElementById('filterForm').submit();">
                <i class="bi bi-x"></i>
            </button>
            {% endif %}
        </div>
        <div class="form-text small mt-1">
            Search dish names, notes, and encyclopedia entries
        </div>
    </div>

    <!-- Link Status Section -->
    <div class="border-bottom p-3">
        <h6 class="mb-3"><i class="bi bi-link-45deg"></i> Encyclopedia Link</h6>
        <select class="form-select form-select-sm" id="link_status" name="link_status">
            <option value="all" {% if filter_params.link_status == 'all' or not filter_params.link_status %}selected{% endif %}>All Dishes</option>
            <option value="linked" {% if filter_params.link_status == 'linked' %}selected{% endif %}>Linked to Encyclopedia</option>
            <option value="unlinked" {% if filter_params.link_status == 'unlinked' %}selected{% endif %}>Not Linked</option>
        </select>
    </div>

    <!-- Restaurant Section -->
    <div class="border-bottom p-3">
        <h6 class="mb-3"><i class="bi bi-shop"></i> Restaurant</h6>
        <select class="form-select form-select-sm" id="restaurant" name="restaurant">
            <option value="">All Restaurants</option>
            {% for restaurant in restaurant_options %}
            <option value="{{ restaurant }}" {% if filter_params.restaurant == restaurant %}selected{% endif %}>
                {{ restaurant }}
            </option>
            {% endfor %}
        </select>
    </div>

    <!-- Encyclopedia Entry Section -->
    <div class="border-bottom p-3">
        <h6 class="mb-3"><i class="bi bi-book"></i> Encyclopedia Entry</h6>
        <select class="form-select form-select-sm" id="encyclopedia_entry" name="encyclopedia_entry">
            <option value="">All Entries</option>
            {% for entry in encyclopedia_options %}
            <option value="{{ entry.id }}" {% if filter_params.encyclopedia_entry.id == entry.id %}selected{% endif %}>
                {{ entry.name }}
            </option>
            {% endfor %}
        </select>
    </div>

    <!-- Rating Section -->
    <div class="border-bottom p-3">
        <h6 class="mb-3"><i class="bi bi-star-fill text-warning"></i> Dish Rating Range</h6>
        <label class="form-label small">
            <span id="rating_min_value">{{ filter_params.rating_min|default:"0" }}</span> -
            <span id="rating_max_value">{{ filter_params.rating_max|default:"100" }}</span>
        </label>
        <div id="rating-slider" style="margin: 15px 10px 10px 10px;"></div>
        <input type="hidden" id="rating_min" name="rating_min" value="{{ filter_params.rating_min|default:"0" }}">
        <input type="hidden" id="rating_max" name="rating_max" value="{{ filter_params.rating_max|default:"100" }}">
    </div>

    <!-- Cost Range Section -->
    <div class="border-bottom p-3">
        <h6 class="mb-3"><i class="bi bi-currency-dollar"></i> Cost Range</h6>
        <div class="mb-2">
            <label for="cost_min" class="form-label small mb-1">Min ($)</label>
            <input type="number" class="form-control form-control-sm" id="cost_min" name="cost_min"
                   min="0" step="0.01" placeholder="0.00"
                   value="{{ filter_params.cost_min }}">
        </div>
        <div class="mb-2">
            <label for="cost_max" class="form-label small mb-1">Max ($)</label>
            <input type="number" class="form-control form-control-sm" id="cost_max" name="cost_max"
                   min="0" step="0.01" placeholder="No limit"
                   value="{{ filter_params.cost_max }}">
        </div>
    </div>

    <!-- Date Range Section -->
    <div class="border-bottom p-3">
        <h6 class="mb-3"><i class="bi bi-calendar3"></i> Visit Date</h6>
        <div class="mb-2">
            <label for="date_from" class="form-label small mb-1">From</label>
            <input type="date" class="form-control form-control-sm" id="date_from" name="date_from"
                   value="{{ filter_params.date_from }}">
        </div>
        <div class="mb-3">
            <label for="date_to" class="form-label small mb-1">To</label>
            <input type="date" class="form-control form-control-sm" id="date_to" name="date_to"
                   value="{{ filter_params.date_to }}">
        </div>
        <div class="d-grid gap-1">
            <button type="button" class="btn btn-sm btn-outline-secondary" onclick="setDateRange(7)">Last Week</button>
            <button type="button" class="btn btn-sm btn-outline-secondary" onclick="setDateRange(30)">Last Month</button>
            <button type="button" class="btn btn-sm btn-outline-secondary" onclick="setDateRange(90)">Last 3 Months</button>
            <button type="button" class="btn btn-sm btn-outline-secondary" onclick="setDateRangeThisYear()">This Year</button>
        </div>
    </div>

    <!-- Sort Section -->
    <div class="border-bottom p-3">
        <h6 class="mb-3"><i class="bi bi-sort-down"></i> Sort By</h6>
        <select class="form-select form-select-sm" id="sort" name="sort">
            {% if filter_params.search %}
            <option value="relevance" {% if filter_params.sort == 'relevance' or not filter_params.sort %}selected{% endif %}>Relevance</option>
            <option value="date_desc" {% if filter_params.sort == 'date_desc' %}selected{% endif %}>Date: Newest First</option>
            {% else %}
            <option value="date_desc" {% if filter_params.sort == 'date_desc' or not filter_params.sort %}selected{% endif %}>Date: Newest First</option>
            {% endif %}
            <option value="date_asc" {% if filter_params.sort == 'date_asc' %}selected{% endif %}>Date: Oldest First</option>
            <option value="rating_desc" {% if filter_params.sort == 'rating_desc' %}selected{% endif %}>Dish Rating: High to Low</option>
            <option value="rating_asc" {% if filter_params.sort == 'rating_asc' %}selected{% endif %}>Dish Rating: Low to High</option>
            <option value="cost_desc" {% if filter_params.sort == 'cost_desc' %}selected{% endif %}>Cost: High to Low</option>
            <option value="cost_asc" {% if filter_params.sort == 'cost_asc' %}selected{% endif %}>Cost: Low to High</option>
            <option value="name_asc" {% if filter_params.sort == 'name_asc' %}selected{% endif %}>Dish Name: A-Z</option>
            <option value="name_desc" {% if filter_params.sort == 'name_desc' %}selected{% endif %}>Dish Name: Z-A</option>
            <option value="restaurant_asc" {% if filter_params.sort == 'restaurant_asc' %}selected{% endif %}>Restaurant: A-Z</option>
            <option value="restaurant_desc" {% if filter_params.sort == 'restaurant_desc' %}selected{% endif %}>Restaurant: Z-A</option>
        </select>
    </div>

    <!-- Action Buttons -->
    <div class="p-3">
        <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary">
                <i class="bi bi-funnel-fill"></i> Apply Filters
            </button>
            <a href="{% url 'content:review_dish_list' %}" class="btn btn-outline-secondary">
                <i class="bi bi-x-circle"></i> Clear All
            </a>
        </div>
    </div>
</form>
