{% load review_tags %}

{# Component: Review Card #}
{# Parameters: review (required) #}

<div class="card h-100">
    {# Image with fallback #}
    {% with display_image=review.get_display_image %}
        {% if display_image %}
        <img src="{{ display_image.image.url }}"
             class="card-img-top"
             alt="{{ review.restaurant_name }}"
             style="height: 200px; object-fit: cover;">
        {% else %}
        <div class="card-img-top bg-light d-flex align-items-center justify-content-center"
             style="height: 200px;">
            <span class="text-muted">No image</span>
        </div>
        {% endif %}
    {% endwith %}

    <div class="card-body">
        <h5 class="card-title">{{ review.restaurant_name }}</h5>
        <p class="card-text text-muted mb-2">
            <small>{{ review.visit_date|date:"F d, Y" }}</small>
            {% if review.location %}
            <br><small>{{ review.location }}</small>
            {% endif %}
        </p>
        <div class="mb-2">
            {{ review.rating|rating_to_stars }}
        </div>
        {% if review.notes %}
        <p class="card-text">
            {{ review.notes|truncatewords:15 }}
        </p>
        {% endif %}
    </div>

    <div class="card-footer">
        <a href="{% url 'content:review_detail' review.pk %}" class="btn btn-primary btn-sm">View Details</a>
    </div>
</div>
